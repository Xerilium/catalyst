name: valid-complete
description: Complete playbook with all optional properties for testing
owner: Engineer

reviewers:
  required:
    - Architect
    - Tech Lead
  optional:
    - Product Manager

triggers:
  - event: issues
    action: opened
    args:
      label: bug
  - event: pull_request
    action: labeled

inputs:
  - string: issue-number
    description: The issue number to process
    required: true
    validation:
      - regex: "^[0-9]+$"
        code: InvalidIssueNumber
        message: Issue number must be numeric
      - minLength: 1
        maxLength: 10

  - number: retry-count
    description: Number of retries
    required: false
    default: 3
    validation:
      - min: 1
        max: 10

  - boolean: dry-run
    description: Run in dry-run mode
    default: false

outputs:
  pr-number: number
  pr-url: string

steps:
  - name: fetch-issue
    custom-action:
      issueNumber: "{{ inputs.issue-number }}"
    timeout: 30

  - name: create-pr
    custom-action: "Create PR from issue"
    labels:
      - automated

catch:
  - code: IssueNotFound
    steps:
      - custom-action: "Log error"

finally:
  - custom-action: "Cleanup resources"
